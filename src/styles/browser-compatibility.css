/* Enhanced Browser Compatibility and Fallbacks */
/* Comprehensive cross-browser support for modern CSS features */

/* Vendor Prefixes for Experimental Features */
@layer base {
  /* Enhanced Backdrop Filter with all vendor prefixes */
  .backdrop-blur-enhanced {
    /* Fallback background */
    background: rgba(34, 39, 46, 0.95);
    /* Webkit prefix for Safari */
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    /* Standard property */
    backdrop-filter: blur(20px) saturate(180%);
  }
  
  /* CSS Grid with vendor prefixes and fallbacks */
  .grid-enhanced {
    /* IE10+ Grid */
    display: -ms-grid;
    -ms-grid-columns: 1fr 1fr 1fr;
    -ms-grid-rows: auto;
    /* Flexbox fallback */
    display: flex;
    flex-wrap: wrap;
    /* Modern Grid */
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
  }
  
  /* Enhanced Flexbox with all prefixes */
  .flex-enhanced {
    /* Old flexbox syntax */
    display: -webkit-box;
    display: -moz-box;
    display: -ms-flexbox;
    /* Modern flexbox */
    display: flex;
    /* Webkit prefix */
    -webkit-flex-direction: row;
    -webkit-align-items: center;
    -webkit-justify-content: center;
    /* Standard properties */
    flex-direction: row;
    align-items: center;
    justify-content: center;
  }
  
  /* Enhanced Transform with all vendor prefixes */
  .transform-enhanced {
    /* Webkit prefix */
    -webkit-transform: translateX(10px) translateY(-5px) scale(1.05);
    /* Mozilla prefix */
    -moz-transform: translateX(10px) translateY(-5px) scale(1.05);
    /* Microsoft prefix */
    -ms-transform: translateX(10px) translateY(-5px) scale(1.05);
    /* Opera prefix */
    -o-transform: translateX(10px) translateY(-5px) scale(1.05);
    /* Standard property */
    transform: translateX(10px) translateY(-5px) scale(1.05);
  }
  
  /* Enhanced Transition with all vendor prefixes */
  .transition-enhanced {
    /* Webkit prefix */
    -webkit-transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
    /* Mozilla prefix */
    -moz-transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
    /* Microsoft prefix */
    -ms-transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
    /* Opera prefix */
    -o-transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
    /* Standard property */
    transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
  }
  
  /* Enhanced Animation with vendor prefixes */
  .animation-enhanced {
    /* Webkit prefix */
    -webkit-animation: fadeIn 1s ease-out forwards;
    /* Mozilla prefix */
    -moz-animation: fadeIn 1s ease-out forwards;
    /* Microsoft prefix */
    -ms-animation: fadeIn 1s ease-out forwards;
    /* Opera prefix */
    -o-animation: fadeIn 1s ease-out forwards;
    /* Standard property */
    animation: fadeIn 1s ease-out forwards;
  }
  
  /* Enhanced Filter with vendor prefixes */
  .filter-enhanced {
    /* Webkit prefix */
    -webkit-filter: blur(5px) brightness(1.1) saturate(1.2);
    /* Standard property */
    filter: blur(5px) brightness(1.1) saturate(1.2);
  }
  
  /* Enhanced User Select with all prefixes */
  .user-select-none {
    /* Webkit prefix */
    -webkit-user-select: none;
    /* Mozilla prefix */
    -moz-user-select: none;
    /* Microsoft prefix */
    -ms-user-select: none;
    /* Standard property */
    user-select: none;
  }
  
  /* Enhanced Box Sizing with vendor prefixes */
  .box-sizing-border {
    /* Webkit prefix */
    -webkit-box-sizing: border-box;
    /* Mozilla prefix */
    -moz-box-sizing: border-box;
    /* Standard property */
    box-sizing: border-box;
  }

/* CSS Feature Detection and Fallbacks */
  /* Backdrop Filter Fallbacks */
  .backdrop-blur-fallback {
    /* Fallback for browsers without backdrop-filter support */
    background: rgba(34, 39, 46, 0.95);
  }
  
  @supports (backdrop-filter: blur(10px)) {
    .backdrop-blur-fallback {
      background: rgba(34, 39, 46, 0.8);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
  }
  
  /* CSS Grid Fallbacks */
  .grid-fallback {
    /* Flexbox fallback for older browsers */
    display: flex;
    flex-wrap: wrap;
  }
  
  @supports (display: grid) {
    .grid-fallback {
      display: grid;
    }
  }
  
  /* CSS Custom Properties Fallbacks */
  .color-fallback {
    /* Static color fallback */
    background-color: #6366f1;
    color: #ffffff;
  }
  
  @supports (color: hsl(var(--accent-primary))) {
    .color-fallback {
      background-color: hsl(var(--accent-primary));
      color: hsl(var(--foreground-primary));
    }
  }
  
  /* Clip-path Fallbacks */
  .clip-path-fallback {
    /* Border-radius fallback */
    border-radius: 50%;
    overflow: hidden;
  }
  
  @supports (clip-path: circle(50%)) {
    .clip-path-fallback {
      border-radius: 0;
      clip-path: circle(50%);
    }
  }
  
  /* CSS Filters Fallbacks */
  .filter-fallback {
    /* Opacity fallback for blur effects */
    opacity: 0.9;
  }
  
  @supports (filter: blur(5px)) {
    .filter-fallback {
      opacity: 1;
      filter: blur(5px);
      -webkit-filter: blur(5px);
    }
  }
  
  /* Sticky Position Fallbacks */
  .sticky-fallback {
    /* Fixed position fallback */
    position: fixed;
    top: 0;
    z-index: 50;
  }
  
  @supports (position: sticky) {
    .sticky-fallback {
      position: sticky;
    }
  }
  
  /* CSS Transforms Fallbacks */
  .transform-fallback {
    /* Margin-based positioning fallback */
    margin-left: 10px;
    margin-top: -5px;
  }
  
  @supports (transform: translateX(10px)) {
    .transform-fallback {
      margin-left: 0;
      margin-top: 0;
      transform: translateX(10px) translateY(-5px);
      -webkit-transform: translateX(10px) translateY(-5px);
      -moz-transform: translateX(10px) translateY(-5px);
      -ms-transform: translateX(10px) translateY(-5px);
    }
  }
  
  /* Flexbox Fallbacks */
  .flex-fallback {
    /* Table-cell fallback for centering */
    display: table-cell;
    vertical-align: middle;
    text-align: center;
  }
  
  @supports (display: flex) {
    .flex-fallback {
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }
  
  /* CSS Animations Fallbacks */
  .animation-fallback {
    /* Static state for browsers without animation support */
    opacity: 1;
    transform: none;
  }
  
  @supports (animation: fadeIn 1s ease) {
    .animation-fallback {
      animation: fadeIn 1s ease;
    }
  }
  
  /* CSS Gradients Fallbacks */
  .gradient-fallback {
    /* Solid color fallback */
    background-color: #6366f1;
  }
  
  @supports (background: linear-gradient(45deg, red, blue)) {
    .gradient-fallback {
      background: linear-gradient(135deg, hsl(var(--accent-primary)), hsl(var(--accent-secondary)));
    }
  }
  
  /* CSS Mask Fallbacks */
  .mask-fallback {
    /* Border and overflow fallback */
    border: 2px solid transparent;
    overflow: hidden;
  }
  
  @supports (mask: linear-gradient(#fff 0 0)) {
    .mask-fallback {
      border: none;
      mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
      mask-composite: xor;
      -webkit-mask-composite: xor;
    }
  }
}

/* Browser-Specific Fixes */
@layer utilities {
  /* Safari-specific fixes */
  @supports (-webkit-appearance: none) {
    .safari-fix {
      /* Fix for Safari's button styling */
      -webkit-appearance: none;
      -webkit-border-radius: 0;
    }
    
    .safari-backdrop-fix {
      /* Enhanced backdrop-filter for Safari */
      -webkit-backdrop-filter: blur(20px) saturate(180%);
      backdrop-filter: blur(20px) saturate(180%);
    }
    
    .safari-transform-fix {
      /* Fix for Safari's transform rendering */
      -webkit-transform-style: preserve-3d;
      transform-style: preserve-3d;
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
    }
  }
  
  /* Firefox-specific fixes */
  @-moz-document url-prefix() {
    .firefox-fix {
      /* Fix for Firefox's scrollbar styling */
      scrollbar-width: thin;
      scrollbar-color: hsl(var(--accent-primary)) hsl(var(--background-secondary));
    }
    
    .firefox-backdrop-fix {
      /* Firefox backdrop-filter alternative */
      background: rgba(34, 39, 46, 0.95);
    }
  }
  
  /* Chrome/Edge-specific fixes */
  @supports (-webkit-background-clip: text) {
    .chrome-gradient-text {
      background: linear-gradient(135deg, hsl(var(--accent-primary)), hsl(var(--accent-secondary)));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }
  }
  
  /* Internet Explorer 11 fallbacks (if needed) */
  @media screen and (-ms-high-contrast: active), (-ms-high-contrast: none) {
    .ie11-fallback {
      /* IE11 flexbox fixes */
      display: -ms-flexbox;
      -ms-flex-align: center;
      -ms-flex-pack: center;
    }
  }
  
  /* Edge Legacy fixes */
  @supports (-ms-ime-align: auto) {
    .edge-legacy-fix {
      /* Edge Legacy grid fixes */
      display: -ms-grid;
      -ms-grid-columns: 1fr 1fr 1fr;
      -ms-grid-rows: auto;
    }
  }
}

/* Performance Optimizations for Different Browsers */
@layer components {
  /* Hardware acceleration for better performance */
  .hw-accelerated {
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
    -moz-transform: translateZ(0);
    -ms-transform: translateZ(0);
    will-change: transform;
  }
  
  /* Optimized animations for different browsers */
  .optimized-animation {
    /* Use transform and opacity for best performance */
    transition: transform 0.3s ease, opacity 0.3s ease;
    -webkit-transition: -webkit-transform 0.3s ease, opacity 0.3s ease;
    -moz-transition: -moz-transform 0.3s ease, opacity 0.3s ease;
    -ms-transition: -ms-transform 0.3s ease, opacity 0.3s ease;
  }
  
  /* Cross-browser smooth scrolling */
  .smooth-scroll {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }
  
  /* Cross-browser user-select */
  .no-select {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
  
  /* Cross-browser box-sizing */
  .border-box {
    box-sizing: border-box;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
  }
}

/* Print Styles */
@media print {
  .no-print {
    display: none !important;
  }
  
  .print-friendly {
    background: white !important;
    color: black !important;
    box-shadow: none !important;
  }
  
  /* Ensure proper page breaks */
  .page-break-before {
    page-break-before: always;
  }
  
  .page-break-after {
    page-break-after: always;
  }
  
  .page-break-inside-avoid {
    page-break-inside: avoid;
  }
}

/* High Contrast Mode Enhancements */
@media (prefers-contrast: high) {
  .high-contrast-enhanced {
    border: 2px solid currentColor !important;
    background: Canvas !important;
    color: CanvasText !important;
  }
  
  .high-contrast-button {
    border: 3px solid ButtonText !important;
    background: ButtonFace !important;
    color: ButtonText !important;
  }
  
  .high-contrast-link {
    color: LinkText !important;
    text-decoration: underline !important;
  }
}

/* Forced Colors Mode (Windows High Contrast) */
@media (forced-colors: active) {
  .forced-colors-fix {
    forced-color-adjust: none;
    border: 1px solid ButtonText;
  }
  
  .forced-colors-auto {
    forced-color-adjust: auto;
  }
}

/* Reduced Data Mode */
@media (prefers-reduced-data: reduce) {
  .data-saver {
    /* Disable heavy animations and effects */
    animation: none !important;
    transition: none !important;
    background-image: none !important;
  }
  
  .data-saver-image {
    /* Provide low-quality image alternatives */
    filter: blur(2px);
    opacity: 0.8;
  }
}

/* Color Gamut Support */
@media (color-gamut: p3) {
  .p3-colors {
    /* Enhanced colors for P3 displays */
    --accent-primary: color(display-p3 0.4 0.2 1);
    --accent-secondary: color(display-p3 0.6 0.2 1);
  }
}

@media (color-gamut: rec2020) {
  .rec2020-colors {
    /* Enhanced colors for Rec2020 displays */
    --accent-primary: color(rec2020 0.4 0.2 1);
    --accent-secondary: color(rec2020 0.6 0.2 1);
  }
}

/* Hover Capability Detection */
@media (hover: none) {
  .no-hover {
    /* Remove hover effects on touch devices */
    transition: none;
  }
  
  .no-hover:hover {
    transform: none !important;
    box-shadow: none !important;
  }
}

@media (hover: hover) {
  .hover-enabled {
    /* Enhanced hover effects for devices with hover capability */
    transition: all 0.3s ease;
  }
}

/* Pointer Capability Detection */
@media (pointer: coarse) {
  .coarse-pointer {
    /* Larger touch targets for coarse pointers */
    min-height: 44px;
    min-width: 44px;
    padding: 12px;
  }
}

@media (pointer: fine) {
  .fine-pointer {
    /* Smaller, more precise targets for fine pointers */
    min-height: 32px;
    min-width: 32px;
    padding: 8px;
  }
}

/* Any-Pointer Detection */
@media (any-pointer: coarse) {
  .any-coarse-pointer {
    /* Accommodate both touch and mouse input */
    min-height: 40px;
    min-width: 40px;
  }
}

/* Enhanced Keyframe Animations with Vendor Prefixes */
@-webkit-keyframes fadeIn {
  from { opacity: 0; -webkit-transform: translateY(20px); }
  to { opacity: 1; -webkit-transform: translateY(0); }
}

@-moz-keyframes fadeIn {
  from { opacity: 0; -moz-transform: translateY(20px); }
  to { opacity: 1; -moz-transform: translateY(0); }
}

@-ms-keyframes fadeIn {
  from { opacity: 0; -ms-transform: translateY(20px); }
  to { opacity: 1; -ms-transform: translateY(0); }
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

@-webkit-keyframes slideUp {
  from { opacity: 0; -webkit-transform: translate3d(0, 20px, 0); }
  to { opacity: 1; -webkit-transform: translate3d(0, 0, 0); }
}

@-moz-keyframes slideUp {
  from { opacity: 0; -moz-transform: translate3d(0, 20px, 0); }
  to { opacity: 1; -moz-transform: translate3d(0, 0, 0); }
}

@keyframes slideUp {
  from { opacity: 0; transform: translate3d(0, 20px, 0); }
  to { opacity: 1; transform: translate3d(0, 0, 0); }
}

@-webkit-keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

@-webkit-keyframes spin {
  from { -webkit-transform: rotate(0deg); }
  to { -webkit-transform: rotate(360deg); }
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

@-webkit-keyframes float {
  0%, 100% { -webkit-transform: translateY(0px); }
  50% { -webkit-transform: translateY(-10px); }
}

@keyframes float {
  0%, 100% { transform: translateY(0px); }
  50% { transform: translateY(-10px); }
}

@-webkit-keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

@-webkit-keyframes bounce {
  0%, 20%, 53%, 80%, 100% { -webkit-transform: translate3d(0, 0, 0); }
  40%, 43% { -webkit-transform: translate3d(0, -30px, 0); }
  70% { -webkit-transform: translate3d(0, -15px, 0); }
  90% { -webkit-transform: translate3d(0, -4px, 0); }
}

@keyframes bounce {
  0%, 20%, 53%, 80%, 100% { transform: translate3d(0, 0, 0); }
  40%, 43% { transform: translate3d(0, -30px, 0); }
  70% { transform: translate3d(0, -15px, 0); }
  90% { transform: translate3d(0, -4px, 0); }
}

/* Browser-Specific Performance Optimizations */
@layer utilities {
  /* Hardware acceleration for all browsers */
  .hw-accelerated-enhanced {
    /* Force hardware acceleration */
    -webkit-transform: translateZ(0);
    -moz-transform: translateZ(0);
    -ms-transform: translateZ(0);
    -o-transform: translateZ(0);
    transform: translateZ(0);
    /* Optimize for animations */
    -webkit-backface-visibility: hidden;
    -moz-backface-visibility: hidden;
    -ms-backface-visibility: hidden;
    backface-visibility: hidden;
    /* Improve rendering */
    -webkit-perspective: 1000px;
    -moz-perspective: 1000px;
    -ms-perspective: 1000px;
    perspective: 1000px;
    /* Optimize repaints */
    will-change: transform, opacity;
  }
  
  /* Enhanced smooth scrolling for all browsers */
  .smooth-scroll-enhanced {
    /* Standard property */
    scroll-behavior: smooth;
    /* iOS momentum scrolling */
    -webkit-overflow-scrolling: touch;
    /* Prevent scroll chaining */
    overscroll-behavior: contain;
    /* Optimize scrolling performance */
    scroll-snap-type: y mandatory;
  }
  
  /* Cross-browser text rendering optimization */
  .text-rendering-optimized {
    /* Webkit text rendering */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    /* Optimize text rendering */
    text-rendering: optimizeLegibility;
    /* Improve font display */
    font-display: swap;
  }
  
  /* Enhanced appearance reset for form elements */
  .appearance-none-enhanced {
    /* Webkit appearance */
    -webkit-appearance: none;
    /* Mozilla appearance */
    -moz-appearance: none;
    /* Standard appearance */
    appearance: none;
    /* Remove default styling */
    border: none;
    outline: none;
    background: none;
  }
}

/* Advanced Browser-Specific Fixes */
@layer components {
  /* Enhanced Safari fixes */
  @supports (-webkit-appearance: none) {
    .safari-enhanced-fix {
      /* Fix backdrop-filter performance */
      -webkit-backdrop-filter: blur(20px) saturate(180%) brightness(120%);
      backdrop-filter: blur(20px) saturate(180%) brightness(120%);
      /* Fix transform rendering issues */
      -webkit-transform-style: preserve-3d;
      transform-style: preserve-3d;
      /* Fix z-index stacking */
      -webkit-transform: translateZ(0);
      transform: translateZ(0);
      /* Fix button styling */
      -webkit-appearance: none;
      -webkit-border-radius: 0;
    }
    
    .safari-gradient-fix {
      /* Fix gradient text rendering */
      background: -webkit-linear-gradient(135deg, #6366f1, #8b5cf6);
      background: linear-gradient(135deg, #6366f1, #8b5cf6);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      /* Fallback for older Safari */
      color: #6366f1;
    }
  }
  
  /* Enhanced Firefox fixes */
  @-moz-document url-prefix() {
    .firefox-enhanced-fix {
      /* Fix scrollbar styling */
      scrollbar-width: thin;
      scrollbar-color: #6366f1 #1f2937;
      /* Fix backdrop-filter alternative */
      background: rgba(34, 39, 46, 0.95);
      /* Fix flexbox issues */
      -moz-box-sizing: border-box;
      box-sizing: border-box;
    }
    
    .firefox-input-fix {
      /* Fix input styling */
      -moz-appearance: none;
      appearance: none;
      /* Fix focus outline */
      outline: none;
      border: 2px solid transparent;
    }
    
    .firefox-input-fix:focus {
      border-color: #6366f1;
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    }
  }
  
  /* Enhanced Chrome/Edge fixes */
  @supports (-webkit-background-clip: text) {
    .chrome-enhanced-fix {
      /* Fix gradient text */
      background: linear-gradient(135deg, #6366f1, #8b5cf6);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      /* Fix selection color */
      -webkit-text-stroke: 1px transparent;
    }
    
    .chrome-scrollbar-fix {
      /* Custom scrollbar styling */
      scrollbar-width: thin;
      scrollbar-color: #6366f1 #1f2937;
    }
    
    .chrome-scrollbar-fix::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    .chrome-scrollbar-fix::-webkit-scrollbar-track {
      background: #1f2937;
      border-radius: 4px;
    }
    
    .chrome-scrollbar-fix::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #6366f1, #8b5cf6);
      border-radius: 4px;
    }
    
    .chrome-scrollbar-fix::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #5b5bd6, #7c3aed);
    }
  }
  
  /* Enhanced input styling for all browsers */
  .input-enhanced {
    /* Reset appearance */
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    /* Enhanced styling */
    border: 2px solid transparent;
    border-radius: 8px;
    padding: 12px 16px;
    font-size: 16px; /* Prevent zoom on iOS */
    background: rgba(255, 255, 255, 0.05);
    color: #f8fafc;
    transition: all 0.3s ease;
  }
  
  .input-enhanced:focus {
    outline: none;
    border-color: #6366f1;
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
    background: rgba(255, 255, 255, 0.1);
  }
  
  /* Enhanced button styling for all browsers */
  .button-enhanced {
    /* Reset appearance */
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    /* Enhanced styling */
    border: none;
    border-radius: 8px;
    padding: 12px 24px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    background: linear-gradient(135deg, #6366f1, #8b5cf6);
    color: white;
    /* Enhanced transitions */
    -webkit-transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
    -moz-transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
    transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1);
    /* Hardware acceleration */
    -webkit-transform: translateZ(0);
    transform: translateZ(0);
    will-change: transform, box-shadow;
  }
  
  .button-enhanced:hover {
    -webkit-transform: translateY(-2px) scale(1.02);
    -moz-transform: translateY(-2px) scale(1.02);
    transform: translateY(-2px) scale(1.02);
    box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);
  }
  
  .button-enhanced:active {
    -webkit-transform: translateY(0) scale(0.98);
    -moz-transform: translateY(0) scale(0.98);
    transform: translateY(0) scale(0.98);
  }
  
  .button-enhanced:focus {
    outline: none;
    box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.4);
  }
}